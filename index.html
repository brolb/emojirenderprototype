<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Emoji Renderer Test</title>
  <style>
    body {
      font-family: sans-serif;
      font-size: 20px;
    }
    img.emoji {
      width: 1em;
      height: 1em;
      vertical-align: middle;
      display: inline-block;
    }
    /* Preserve whitespace for tabular emoji text */
    #output {
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div id="output">[Loading renderer...]</div>

  <script type="module">
    import { parse } from 'https://cdn.skypack.dev/twemoji-parser';

    const emojiBasePath = 'emojis/';
    const text = `Smileys & Emotion\nface-smiling\nâ„–\tCode\tEmoji\n1\tU+1F600\tðŸ˜€\n2\tU+1F603\tðŸ˜ƒ\n3\tU+1F604\tðŸ˜„\n4\tU+1F601\tðŸ˜\n5\tU+1F606\tðŸ˜†\n6\tU+1F605\tðŸ˜…\n7\tU+1F923\tðŸ¤£\n8\tU+1F602\tðŸ˜‚\n9\tU+1F642\tðŸ™‚\n10\tU+1F643\tðŸ™ƒ\n11\tU+1FAE0\tðŸ« \n12\tU+1F609\tðŸ˜‰\n13\tU+1F60A\tðŸ˜Š\n14\tU+1F607\tðŸ˜‡\nface-affection\nâ„–\tCode\tEmoji\n15\tU+1F970\tðŸ¥°\n16\tU+1F60D\tðŸ˜\n17\tU+1F929\tðŸ¤©\n18\tU+1F618\tðŸ˜˜\n19\tU+1F617\tðŸ˜—\n20\tU+263A\tâ˜º\n21\tU+1F61A\tðŸ˜š\n22\tU+1F619\tðŸ˜™\n23\tU+1F972\tðŸ¥²\nface-tongue\nâ„–\tCode\tEmoji\n24\tU+1F60B\tðŸ˜‹\n25\tU+1F61B\tðŸ˜›\n26\tU+1F61C\tðŸ˜œ\n27\tU+1F92A\tðŸ¤ª\n28\tU+1F61D\tðŸ˜\n29\tU+1F911\tðŸ¤‘\nface-hand\nâ„–\tCode\tEmoji\n30\tU+1F917\tðŸ¤—\n31\tU+1F92D\tðŸ¤­\n32\tU+1FAE2\tðŸ«¢\n33\tU+1FAE3\tðŸ«£\n34\tU+1F92B\tðŸ¤«\n35\tU+1F914\tðŸ¤”\n36\tU+1FAE1\tðŸ«¡\nface-neutral-skeptical\nâ„–\tCode\tEmoji\n37\tU+1F910\tðŸ¤\n38\tU+1F928\tðŸ¤¨\n39\tU+1F610\tðŸ˜\n40\tU+1F611\tðŸ˜‘\n41\tU+1F636\tðŸ˜¶\n42\tU+1FAE5\tðŸ«¥\n43\tU+1F636 U+200D U+1F32B U+FE0F\tðŸ˜¶â€ðŸŒ«ï¸\n44\tU+1F60F\tðŸ˜\n45\tU+1F612\tðŸ˜’\n46\tU+1F644\tðŸ™„\n47\tU+1F62C\tðŸ˜¬\n48\tU+1F62E U+200D U+1F4A8\tðŸ˜®â€ðŸ’¨\n49\tU+1F925\tðŸ¤¥\n50\tU+1FAE8\tðŸ«¨\n51\tU+1F642 U+200D U+2194 U+FE0F\tðŸ™‚â€â†”ï¸\n52\tU+1F642 U+200D U+2195 U+FE0F\tðŸ™‚â€â†•ï¸\nface-sleepy\nâ„–\tCode\tEmoji\n53\tU+1F60C\tðŸ˜Œ\n54\tU+1F614\tðŸ˜”\n55\tU+1F62A\tðŸ˜ª\n56\tU+1F924\tðŸ¤¤\n57\tU+1F634\tðŸ˜´\n58\tU+1FAE9\tðŸ«©\nface-unwell\nâ„–\tCode\tEmoji\n59\tU+1F637\tðŸ˜·\n60\tU+1F912\tðŸ¤’\n61\tU+1F915\tðŸ¤•\n62\tU+1F922\tðŸ¤¢\n63\tU+1F92E\tðŸ¤®\n64\tU+1F927\tðŸ¤§\n65\tU+1F975\tðŸ¥µ\n66\tU+1F976\tðŸ¥¶\n67\tU+1F974\tðŸ¥´\n68\tU+1F635\tðŸ˜µ\n69\tU+1F635 U+200D U+1F4AB\tðŸ˜µâ€ðŸ’«\n70\tU+1F92F\tðŸ¤¯\nface-hat\nâ„–\tCode\tEmoji\n71\tU+1F920\tðŸ¤ \n72\tU+1F973\tðŸ¥³\n73\tU+1F978\tðŸ¥¸\nface-glasses\nâ„–\tCode\tEmoji\n74\tU+1F60E\tðŸ˜Ž\n75\tU+1F913\tðŸ¤“\n76\tU+1F9D0\tðŸ§\nface-concerned\nâ„–\tCode\tEmoji\n77\tU+1F615\tðŸ˜•\n78\tU+1FAE4\tðŸ«¤\n79\tU+1F61F\tðŸ˜Ÿ\n80\tU+1F641\tðŸ™\n81\tU+2639\tâ˜¹\n82\tU+1F62E\tðŸ˜®\n83\tU+1F62F\tðŸ˜¯\n84\tU+1F632\tðŸ˜²\n85\tU+1F633\tðŸ˜³\n86\tU+1F97A\tðŸ¥º\n87\tU+1F979\tðŸ¥¹\n88\tU+1F626\tðŸ˜¦\n89\tU+1F627\tðŸ˜§\n90\tU+1F628\tðŸ˜¨\n91\tU+1F630\tðŸ˜°\n92\tU+1F625\tðŸ˜¥\n93\tU+1F622\tðŸ˜¢\n94\tU+1F62D\tðŸ˜­\n95\tU+1F631\tðŸ˜±\n96\tU+1F616\tðŸ˜–\n97\tU+1F623\tðŸ˜£\n98\tU+1F61E\tðŸ˜ž\n99\tU+1F613\tðŸ˜“\n100\tU+1F629\tðŸ˜©\n101\tU+1F62B\tðŸ˜«\n102\tU+1F971\tðŸ¥±\nface-negative\nâ„–\tCode\tEmoji\n103\tU+1F624\tðŸ˜¤\n104\tU+1F621\tðŸ˜¡\n105\tU+1F620\tðŸ˜ \n106\tU+1F92C\tðŸ¤¬\n107\tU+1F608\tðŸ˜ˆ\n108\tU+1F47F\tðŸ‘¿\n109\tU+1F480\tðŸ’€\n110\tU+2620\tâ˜ \nface-costume\nâ„–\tCode\tEmoji\n111\tU+1F4A9\tðŸ’©\n112\tU+1F921\tðŸ¤¡\n113\tU+1F479\tðŸ‘¹\n114\tU+1F47A\tðŸ‘º\n115\tU+1F47B\tðŸ‘»\n116\tU+1F47D\tðŸ‘½\n117\tU+1F47E\tðŸ‘¾\n118\tU+1F916\tðŸ¤–\ncat-face\nâ„–\tCode\tEmoji\n119\tU+1F63A\tðŸ˜º\n120\tU+1F638\tðŸ˜¸\n121\tU+1F639\tðŸ˜¹\n122\tU+1F63B\tðŸ˜»\n123\tU+1F63C\tðŸ˜¼\n124\tU+1F63D\tðŸ˜½\n125\tU+1F640\tðŸ™€\n126\tU+1F63F\tðŸ˜¿\n127\tU+1F63E\tðŸ˜¾\nmonkey-face\nâ„–\tCode\tEmoji\n128\tU+1F648\tðŸ™ˆ\n129\tU+1F649\tðŸ™‰\n130\tU+1F64A\tðŸ™Š\nheart\nâ„–\tCode\tEmoji\n131\tU+1F48C\tðŸ’Œ\n132\tU+1F498\tðŸ’˜\n133\tU+1F49D\tðŸ’\n134\tU+1F496\tðŸ’–\n135\tU+1F497\tðŸ’—\n136\tU+1F493\tðŸ’“\n137\tU+1F49E\tðŸ’ž\n138\tU+1F495\tðŸ’•\n139\tU+1F49F\tðŸ’Ÿ\n140\tU+2763\tâ£\n141\tU+1F494\tðŸ’”\n142\tU+2764 U+FE0F U+200D U+1F525\tâ¤ï¸â€ðŸ”¥\n143\tU+2764 U+FE0F U+200D U+1FA79\tâ¤ï¸â€ðŸ©¹\n144\tU+2764\tâ¤\n145\tU+1FA77\tðŸ©·\n146\tU+1F9E1\tðŸ§¡\n147\tU+1F49B\tðŸ’›\n148\tU+1F49A\tðŸ’š\n149\tU+1F499\tðŸ’™\n150\tU+1FA75\tðŸ©µ\n151\tU+1F49C\tðŸ’œ\n152\tU+1F90E\tðŸ¤Ž\n153\tU+1F5A4\tðŸ–¤\n154\tU+1FA76\tðŸ©¶\n155\tU+1F90D\tðŸ¤\nemotion\nâ„–\tCode\tEmoji\n156\tU+1F48B\tðŸ’‹\n157\tU+1F4AF\tðŸ’¯\n158\tU+1F4A2\tðŸ’¢\n159\tU+1F4A5\tðŸ’¥\n160\tU+1F4AB\tðŸ’«\n161\tU+1F4A6\tðŸ’¦\n162\tU+1F4A8\tðŸ’¨\n163\tU+1F573\tðŸ•³\n164\tU+1F4AC\tðŸ’¬\n165\tU+1F441 U+FE0F U+200D U+1F5E8 U+FE0F\tðŸ‘ï¸â€ðŸ—¨ï¸\n166\tU+1F5E8\tðŸ—¨\n167\tU+1F5EF\tðŸ—¯\n168\tU+1F4AD\tðŸ’­\n169\tU+1F4A4\tðŸ’¤`;

    function emojiToFilename(emoji) {
      return Array.from(emoji)
        .map(c => c.codePointAt(0).toString(16))
        .join('-') + '.png';
    }

    function renderTextWithEmojis(text) {
      const container = document.createElement('span');
      const emojiTokens = parse(text);
      let currentIndex = 0;

      for (const token of emojiTokens) {
        if (token.indices[0] > currentIndex) {
          const beforeText = text.slice(currentIndex, token.indices[0]);
          // Replace \n with <br> and \t with spaces for tabular display
          const html = beforeText.replace(/\n/g, '<br>').replace(/\t/g, '    ');
          const temp = document.createElement('span');
          temp.innerHTML = html;
          container.appendChild(temp);
        }

        const filename = emojiToFilename(token.text);
        const img = document.createElement('img');
        img.className = 'emoji';
        img.src = emojiBasePath + filename;
        img.alt = token.text;
        container.appendChild(img);

        currentIndex = token.indices[1];
      }

      if (currentIndex < text.length) {
        const afterText = text.slice(currentIndex);
        const html = afterText.replace(/\n/g, '<br>').replace(/\t/g, '    ');
        const temp = document.createElement('span');
        temp.innerHTML = html;
        container.appendChild(temp);
      }

      return container;
    }

    const output = document.getElementById('output');
    output.textContent = '';
    output.appendChild(renderTextWithEmojis(text));
  </script>
</body>
</html>